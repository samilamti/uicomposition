@{
    ViewBag.Title = "Home Page";
}

<div class="jumbotron">
    <h1>Policy creation guide</h1>
    <p class="lead">This wizard will guide you through creating a policy</p>
</div>

<div class="row">
    <div class="col-md-4">
        <h2>Step 1 - Who's your lead?</h2>
        <p>
            <span id="lead-response" class="details text text-success"></span>
            <a class="btn btn-default" style="float: right" id="lead-trigger">Select lead »</a>
        </p>
    </div>
    <div class="col-md-4">
        <h2>Step 2 - Billing address</h2>
        <p>
            <span id="billing-response" class="details text text-success"></span>
            <a class="btn btn-default" style="float: right" id="billing-trigger">Select billing address »</a>
        </p>
    </div>
    <div class="col-md-4">
        <h2>Web Hosting</h2>
        <p>You can easily find a web hosting company that offers the right mix of features and price for your applications.</p>
        <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301867">Learn more &raquo;</a>
        </p>
    </div>
</div>
@section scripts {
    <script src="~/bower_components/uicomposition/uicomposition.js"></script>
    <script defer>
        var policyId = '916B6051-2266-4ED2-A4E4-D3078A27E9A5'; // Generated by client
        
        window.uicomposition.host.registerComponent({
            serviceComponent: 'person/find-person',
            src: 'http://localhost:3000/selectLead.js',
            targetElementId: 'lead-trigger',
            responseElementId: 'lead-response',
            events: {
                'personSelected': function(args) {
                    $("#lead-response")
                        .text(args.presentation)
                        .fadeIn();
                    $("#lead-trigger")
                        .text("(change)")
                        .removeClass('btn-default')
                        .addClass('btn-link');
                },
                'accept': function(args) {
                    console.log('accept');
                }
            }

        });

        window.uicomposition.host.registerComponent({
            serviceComponent: 'billing/select-billing-address',
            src: 'http://localhost:51372/billingAddress.js',
            targetElementId: 'billing-trigger',
            responseElementId: 'billing-response',
            events: {
                'accept': function(args) {
                    $('#billing-response')
                        .text(args.presentation);
                    $('#billing-trigger')
                        .text("(change)")
                        .removeClass('btn-default')
                        .addClass('btn-link');
                }
            }
        });

        window.uicomposition.listenFor('person/find-person', 'personSelected', function (args) {
            window.uicomposition.host.activateServiceComponent('billing/select-billing-address', {
                addressId: args.addressId,
                legalEntityId: args.personId,
                resourceId: policyId
            });
        });
    </script>
}